# Data Model: RAG Qdrant Implementation

## Content Chunk Entity

**Description**: A segment of extracted book content suitable for embedding generation

**Fields**:
- `chunk_id`: Unique identifier for the content chunk
- `content`: The actual text content of the chunk
- `source_document_id`: Reference to the original document
- `position`: Sequential position within the source document
- `word_count`: Number of words in the chunk
- `created_at`: Timestamp of chunk creation

**Validation Rules**:
- Content must be between 100-500 words for optimal embedding generation
- Position must be a positive integer
- Content cannot be empty

## Embedding Vector Entity

**Description**: A numerical representation of content text generated by Cohere models

**Fields**:
- `embedding_id`: Unique identifier for the embedding
- `vector`: Array of numerical values representing the embedding
- `chunk_id`: Reference to the source content chunk
- `model_name`: Name of the embedding model used (e.g., "cohere-embed-multilingual-v3.0")
- `created_at`: Timestamp of embedding creation

**Validation Rules**:
- Vector must have consistent dimensions (typically 1024 for Cohere)
- Chunk_id must reference an existing content chunk
- Model name must be from approved list

## Document Metadata Entity

**Description**: Information about the source document

**Fields**:
- `document_id`: Unique identifier for the document
- `url`: Public URL of the Docusaurus page
- `title`: Title of the document
- `source_type`: Type of source (e.g., "docusaurus-page")
- `processing_status`: Current status (e.g., "pending", "extracted", "embedded", "stored")
- `created_at`: Timestamp of document record creation
- `updated_at`: Timestamp of last update

**Validation Rules**:
- URL must be a valid, publicly accessible URL
- Title cannot be empty
- Processing status must be from predefined list

## Qdrant Collection Schema

**Description**: Storage container schema in Qdrant database

**Fields**:
- `id`: Unique identifier for the vector record
- `vector`: The embedding vector data
- `payload`: JSON object containing metadata
  - `chunk_id`: Reference to the content chunk
  - `document_id`: Reference to the source document
  - `document_title`: Title of the source document
  - `url`: Source URL for the content
  - `position`: Position within the document

**Validation Rules**:
- Vector dimensions must match the configured model (typically 1024)
- Payload must contain all required metadata fields
- ID must be unique within the collection

## Processing Job Entity

**Description**: Track batch processing jobs for content ingestion

**Fields**:
- `job_id`: Unique identifier for the processing job
- `status`: Current status (e.g., "running", "completed", "failed")
- `total_documents`: Number of documents to process
- `processed_documents`: Number of documents processed
- `failed_documents`: Number of documents that failed processing
- `start_time`: When the job started
- `end_time`: When the job completed
- `error_log`: Any errors encountered during processing

**Validation Rules**:
- Status must be from predefined list
- Processed and failed counts cannot exceed total count
- Start time must be before end time if job is completed